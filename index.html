<html>
  <head>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
  </head>
  <body>
    <a-scene background="color: black">

      <!-- LIGHTING -->
      <a-entity light="type: directional; intensity: 1" position="1 2 2"></a-entity>
      <a-entity light="type: ambient; intensity: 0.5"></a-entity>

      <!-- MINE MODEL -->
      <a-entity id="mine"
        gltf-model="mine_ar_map.glb"
        position="0 0 -8"
        scale="6 6 6"
        rotation="0 30 0">
      </a-entity>

      <!-- Example clickable ZONES -->
      <a-box id="zone1" position="-1 0 -6" depth="1" height="1" width="1" color="red" opacity="0.5"></a-box>
      <a-box id="zone2" position="2 0 -7" depth="1" height="1" width="1" color="blue" opacity="0.5"></a-box>

      <!-- INFO PANEL -->
      <a-entity id="infoPanel" visible="false" position="0 2 -3">
        <a-plane width="2.5" height="1.2" color="black" opacity="0.8"></a-plane>
        <a-text id="infoText" value="Zone info here" color="white" wrap-count="30" align="center" position="0 0 0.1"></a-text>
      </a-entity>

      <!-- CAMERA -->
      <a-entity id="rig" position="0 1.6 0">
        <a-camera></a-camera>
      </a-entity>

      <script>
        // Info database
        const zoneInfo = {
          zone1: "Zone 1 has 10% gas leakage risk. Escape time: 3 mins.",
          zone2: "Zone 2 has 15% rockfall chances. Escape time: 5 mins."
        };

        // Click listener for zones
        document.querySelectorAll("#zone1, #zone2").forEach(zone => {
          zone.addEventListener("click", function () {
            let panel = document.querySelector("#infoPanel");
            let text = document.querySelector("#infoText");
            text.setAttribute("value", zoneInfo[this.id]); // set info text
            panel.setAttribute("visible", "true");
          });
        });

        // Hide info panel if user presses ESC
        window.addEventListener("keydown", (e) => {
          if (e.key === "Escape") {
            document.querySelector("#infoPanel").setAttribute("visible", "false");
          }
        });
      </script>

    </a-scene>
  </body>
</html>
